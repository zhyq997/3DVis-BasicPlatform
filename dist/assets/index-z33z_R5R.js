var p=(t,e,d)=>new Promise((u,w)=>{var y=m=>{try{C(d.next(m))}catch(v){w(v)}},h=m=>{try{C(d.throw(m))}catch(v){w(v)}},C=m=>m.done?u(m.value):Promise.resolve(m.value).then(y,h);C((d=d.apply(t,e)).next())});import{m as s,u as Re,_ as je}from"./entry/index-BNp4bmLj-1732066199007.js";import{u as Ge}from"./use-lifecycle-CyVQVRUS.js";import{d as Ve,f as E,o as Be,a6 as j,a7 as b,Z as Ke,a8 as Ae,a9 as n,k as o,G as i,$ as G}from"./vue-D4H2Ux2Y.js";import"./antd-DgCI0x_J.js";let k,a;const He=new s.BaseClass;let S;function Fe(t){k=t,a=new s.layer.GraphicLayer({hasEdit:!0,isAutoEditing:!0}),k.addLayer(a),k.on(s.EventType.mouseOut,function(e){k.closeSmallTooltip()}),a.on(s.EventType.click,function(e){}),a.on(s.EventType.drawStart,function(e){}),a.on(s.EventType.drawAddPoint,function(e){}),a.on(s.EventType.drawRemovePoint,function(e){}),a.on(s.EventType.drawCreated,function(e){}),a.on(s.EventType.editStart,function(e){}),a.on(s.EventType.editMovePoint,function(e){}),a.on(s.EventType.editAddPoint,function(e){}),a.on(s.EventType.editRemovePoint,function(e){}),a.on(s.EventType.editStop,function(e){}),a.on(s.EventType.removeGraphic,function(e){}),O(),k.on(s.EventType.keydown,function(e){S=e.keyCode}),k.on(s.EventType.keyup,function(e){S=void 0})}function Ie(){a.clear(),k=null}function B(){return p(this,null,function*(){const t=yield a.startDraw({type:"point",style:{pixelSize:12,color:"#3388ff",label:{text:"可以同时支持文字",font_size:20,color:"#ffffff",outline:!0,outlineColor:"#000000",pixelOffsetY:-20}}})})}function K(){return p(this,null,function*(){const t=yield a.startDraw({type:"billboard",style:{image:"img/marker/mark-red.png",horizontalOrigin:Cesium.HorizontalOrigin.CENTER,verticalOrigin:Cesium.VerticalOrigin.BOTTOM,label:{text:"可以同时支持文字",font_size:26,color:"#ffffff",outline:!0,outlineColor:"#000000",pixelOffsetY:-60}}})})}function A(){return p(this,null,function*(){const t=yield a.startDraw({type:"label",style:{text:"火星科技三维地球",color:"#0081c2",font_size:50,outline:!0,outlineColor:"#ffffff",outlineWidth:2}})})}function H(){return p(this,null,function*(){const t=yield a.startDraw({type:"model",style:{scale:10,url:"//data.mars3d.cn/gltf/mars/firedrill/xiaofangche.gltf"}})})}function F(t){return p(this,null,function*(){const e=yield a.startDraw({type:"polyline",style:{color:t?"#ffff00":"#3388ff",width:3,clampToGround:t},updateDrawPosition:function(d,u){return S===67?d=V(d,u.lastDrawPoint,1):S===86&&(d=V(d,u.lastDrawPoint,2)),d}})})}function V(t,e,d){return!e||!t?t:(t=s.LngLatPoint.fromCartesian(t),e=s.LngLatPoint.fromCartesian(e),d===1?t.lat=e.lat:t.lng=e.lng,t.toCartesian())}function I(t){return p(this,null,function*(){const e=yield a.startDraw({type:"brushLine",style:{color:t?"#ffff00":"#3388ff",width:3,clampToGround:t}})})}function Y(t){return p(this,null,function*(){const e=yield a.startDraw({type:"polygon",style:{color:t?"#ffff00":"#3388ff",opacity:.5,outline:!0,outlineColor:"#ffffff",outlineWidth:2,clampToGround:t}})})}function Q(t){return p(this,null,function*(){const e=yield a.startDraw({type:"curve",style:{color:t?"#ffff00":"#3388ff",width:3,clampToGround:t}})})}function Z(t){return p(this,null,function*(){const e=yield a.startDraw({type:"corridor",style:{color:t?"#ffff00":"#3388ff",opacity:.6,width:500,clampToGround:t}})})}function q(t){return p(this,null,function*(){const e=yield a.startDraw({type:"circle",style:{color:t?"#ffff00":"#3388ff",opacity:.6,outline:!0,outlineColor:"#ffffff",outlineWidth:2,clampToGround:t}})})}function X(t){return p(this,null,function*(){const e=yield a.startDraw({type:"rectangle",style:{color:t?"#ffff00":"#3388ff",opacity:.6,outline:!0,outlineColor:"#ffffff",outlineWidth:2,clampToGround:t}})})}function ee(){return p(this,null,function*(){const t=yield a.startDraw({type:"plane",style:{color:"#00ff00",opacity:.8,plane_normal:"x",dimensions_x:1e3,dimensions_y:1e3}})})}function te(t){return p(this,null,function*(){const e=yield a.startDraw({type:"wall",style:{color:"#00ff00",opacity:.8,diffHeight:400,closure:t}})})}function ne(){return p(this,null,function*(){const t=yield a.startDraw({type:"box",style:{color:"#00ff00",opacity:.6,dimensions_x:1e3,dimensions_y:1e3,dimensions_z:1e3}})})}function oe(){return p(this,null,function*(){const t=yield a.startDraw({type:"cylinder",style:{fill:!0,color:"#00ff00",opacity:.6,length:1e3}})})}function ae(){return p(this,null,function*(){const t=yield a.startDraw({type:"ellipsoid",style:{fill:!0,color:"#00ff00",opacity:.6}})})}function le(){return p(this,null,function*(){const t=yield a.startDraw({type:"polygon",style:{color:"#00ff00",opacity:.6,diffHeight:300}})})}function ie(){return p(this,null,function*(){const t=yield a.startDraw({type:"rectangle",style:{color:"#00ff00",opacity:.6,diffHeight:300}})})}function re(){return p(this,null,function*(){const t=yield a.startDraw({type:"circle",style:{color:"#00ff00",opacity:.6,diffHeight:300}})})}function se(){return p(this,null,function*(){const t=yield a.startDraw({type:"satellite",style:{tle1:"1 39150U 13018A   21180.50843864  .00000088  00000-0  19781-4 0  9997",tle2:"2 39150  97.8300 252.9072 0018449 344.7422  15.3253 14.76581022440650",path_show:!0,path_color:"#00ff00",path_width:1,model_show:!0,model_url:"//data.mars3d.cn/gltf/mars/weixin.gltf",model_scale:1,model_minimumPixelSize:90}});setTimeout(()=>{t.flyToPoint()},100)})}function ce(){a.bindPopup(function(t){const e=t.graphic.attr||{};return e.类型=t.graphic.type,e.来源="我是layer上绑定的Popup",e.备注="我支持鼠标交互",s.Util.getTemplateHtml({title:"矢量图层",template:"all",attr:e})})}function O(){a.bindContextMenu([{text:"开始编辑对象",icon:"fa fa-edit",show:function(t){const e=t.graphic;return!e||!e.hasEdit?!1:!e.isEditing},callback:t=>{const e=t.graphic;if(!e)return!1;e&&a.startEditing(e)}},{text:"停止编辑对象",icon:"fa fa-edit",show:function(t){const e=t.graphic;return!e||!e.hasEdit?!1:e.isEditing},callback:t=>{const e=t.graphic;if(!e)return!1;e&&e.stopEditing()}},{text:"删除对象",icon:"fa fa-trash-o",show:t=>{const e=t.graphic;return!(!e||e.isDestroy)},callback:t=>{const e=t.graphic;if(!e)return;const d=e.parent;a.removeGraphic(e),d&&a.removeGraphic(d)}},{text:"计算长度",icon:"fa fa-medium",show:function(t){const e=t.graphic;return e?e.type==="polyline"||e.type==="polylineP"||e.type==="curve"||e.type==="curveP"||e.type==="polylineVolume"||e.type==="polylineVolumeP"||e.type==="corridor"||e.type==="corridorP"||e.type==="wall"||e.type==="wallP":!1},callback:t=>{const e=t.graphic;s.MeasureUtil.formatDistance(e.distance)}},{text:"计算周长",icon:"fa fa-medium",show:function(t){const e=t.graphic;return e?e.type==="circle"||e.type==="circleP"||e.type==="rectangle"||e.type==="rectangleP"||e.type==="polygon"||e.type==="polygonP":!1},callback:t=>{const e=t.graphic;s.MeasureUtil.formatDistance(e.distance)}},{text:"计算面积",icon:"fa fa-reorder",show:function(t){const e=t.graphic;return e?e.type==="circle"||e.type==="circleP"||e.type==="rectangle"||e.type==="rectangleP"||e.type==="polygon"||e.type==="polygonP"||e.type==="scrollWall"||e.type==="water":!1},callback:t=>{const e=t.graphic;s.MeasureUtil.formatArea(e.area)}}])}function fe(t){k.onlyVertexPosition=t}function de(t){const e=t.name,d=e==null?void 0:e.substring(e.lastIndexOf(".")+1,e.length).toLowerCase();if(d==="json"||d==="geojson"){const u=new FileReader;u.readAsText(t,"UTF-8"),u.onloadend=function(w){let y=this.result;y=$(y),a.loadGeoJSON(y,{flyTo:!0})}}else if(d==="kml"){const u=new FileReader;u.readAsText(t,"UTF-8"),u.onloadend=function(w){const y=this.result;kgUtil.toGeoJSON(y).then(h=>{h=$(h),a.loadGeoJSON(h,{flyTo:!0})})}}else d==="kmz"&&kgUtil.toGeoJSON(t).then(u=>{u=$(u),a.loadGeoJSON(u,{flyTo:!0})})}function $(t){try{t=turf.simplify(t,{tolerance:1e-6,highQuality:!0,mutate:!0})}catch(e){}return t}function ue(){if(a.length===0)return;const t=a.toGeoJSON();s.Util.downloadFile("我的标注.json",JSON.stringify(t))}function pe(){if(a.length===0)return;let t=a.toGeoJSON();if(t==null)return null;t=JSON.parse(JSON.stringify(t));const e=kgUtil.toKml(t,{name:"Mars3D标绘数据",documentName:"Mars3D标绘数据文件",documentDescription:"标绘数据 by mars3d.cn",simplestyle:!0});s.Util.downloadFile("我的标注.kml",e)}function ge(){if(a.length===0)return;let t=a.toGeoJSON();if(t==null)return null;t=JSON.parse(JSON.stringify(t));const e=[];let d=0;t.features.forEach(u=>{const w=u.properties,y=u.properties.style,h=Terraformer.WKT.convert(u.geometry);e.push({id:++d,name:w.name||"",remark:w.remark||"",style:y,wkt:h})}),s.Util.downloadFile("我的标注wkt.txt",JSON.stringify(e))}const Ye=Object.freeze(Object.defineProperty({__proto__:null,bindLayerContextMenu:O,bindLayerPopup:ce,draPlane:ee,draWall:te,drawBox:ne,drawBrushLine:I,drawCorridor:Z,drawCurve:Q,drawCylinder:oe,drawEllipse:q,drawEllipsoid:ae,drawExtrudedCircle:re,drawExtrudedPolygon:le,drawExtrudedRectangle:ie,drawLabel:A,drawMarker:K,drawPoint:B,drawPolygon:Y,drawPolyline:F,drawRectangle:X,drawSatellite:se,eventTarget:He,get graphicLayer(){return a},get map(){return k},onMounted:Fe,onUnmounted:Ie,openGeoJSON:de,saveGeoJSON:ue,saveKML:pe,saveWKT:ge,startDrawModel:H,updateOnlyVertexPosition:fe},Symbol.toStringTag,{value:"Module"})),Qe={class:"grid-checkboxs"},Ze={class:"grid-btns"},qe=Ve({__name:"index",setup(t){Ge(Ye);const e=E(!0),d=()=>{a.show=e.value},u=E(!1),w=()=>{u.value?ce():a.unbindPopup()},y=E(!1),h=()=>{y.value?a.bindTooltip("我是layer上绑定的Tooltip"):a.unbindTooltip()},C=E(!0),m=()=>{C.value?O():a.unbindContextMenu(!0)},v=E(!0),ye=()=>{a.hasEdit=v.value},P=E(!1),we=()=>{fe(P.value)},he=()=>{a.clear()},me=()=>{ue()},ke=f=>{de(f.file)},ve=()=>{pe()},Ce=()=>{ge()};function _e(){B()}function be(){K()}function xe(){A()}function Ee(){H()}function D(f){F(f)}function J(f){I(f)}function N(f){Y(f)}function U(f){Q(f)}function M(f){Z(f)}function L(f){q(f)}function W(f){X(f)}function Te(){ee()}function z(f){te(f)}function Se(){ne()}function Pe(){oe()}function $e(){ae()}function Oe(){le()}function De(){ie()}function Je(){re()}const{activate:Ne,disable:Ue,isActivate:Me,updateWidget:Le}=Re();Be(()=>{a.on(s.EventType.drawCreated,function(f){v.value&&R(f)}),a.on([s.EventType.editStart,s.EventType.editMovePoint,s.EventType.editStyle,s.EventType.editRemovePoint],function(f){R(f)}),a.on([s.EventType.editStop,s.EventType.removeGraphic],function(f){setTimeout(()=>{a.isEditing||Ue("graphic-editor")},100)})});const R=f=>{const l=f.graphic;l._conventStyleJson||(l.options.style=l.toJSON().style,l._conventStyleJson=!0),Me("graphic-editor")?Le("graphic-editor",{data:{graphic:j(l)}}):Ne({name:"graphic-editor",data:{graphic:j(l)}})};return(f,l)=>{const g=b("a-col"),x=b("a-checkbox"),_=b("a-row"),r=b("mars-button"),We=b("a-upload"),T=b("a-space"),ze=b("mars-dialog");return Ke(),Ae(ze,{right:"10",top:"60",width:"335",title:"图上标绘"},{default:n(()=>[o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("图层管理:")]),_:1}),o(g,{span:18},{default:n(()=>[G("div",Qe,[o(x,{checked:e.value,"onUpdate:checked":l[0]||(l[0]=c=>e.value=c),onChange:d},{default:n(()=>[i("显示隐藏")]),_:1},8,["checked"]),o(x,{checked:u.value,"onUpdate:checked":l[1]||(l[1]=c=>u.value=c),onChange:w},{default:n(()=>[i("Popup绑定")]),_:1},8,["checked"]),o(x,{checked:y.value,"onUpdate:checked":l[2]||(l[2]=c=>y.value=c),onChange:h},{default:n(()=>[i("Tooltip绑定")]),_:1},8,["checked"]),o(x,{checked:C.value,"onUpdate:checked":l[3]||(l[3]=c=>C.value=c),onChange:m},{default:n(()=>[i("右键菜单绑定")]),_:1},8,["checked"]),o(x,{checked:v.value,"onUpdate:checked":l[4]||(l[4]=c=>v.value=c),onChange:ye},{default:n(()=>[i("是否编辑")]),_:1},8,["checked"]),o(x,{checked:P.value,"onUpdate:checked":l[5]||(l[5]=c=>P.value=c),onChange:we},{default:n(()=>[i("开启顶点吸附 ")]),_:1},8,["checked"])])]),_:1})]),_:1}),o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("数据管理:")]),_:1}),o(g,{span:18},{default:n(()=>[G("div",Ze,[o(We,{multiple:!1,name:"file",accept:"json,geojson,kml,kmz",showUploadList:!1,onChange:ke,beforeUpload:()=>!1},{default:n(()=>[o(r,{class:"open-btn"},{default:n(()=>[i("打开")]),_:1})]),_:1}),o(r,{class:"save-btn",onClick:me},{default:n(()=>[i("保存GeoJSON")]),_:1}),o(r,{class:"kml-btn",onClick:ve},{default:n(()=>[i("另存KML")]),_:1}),o(r,{class:"wkt-btn",onClick:Ce},{default:n(()=>[i("另存WKT")]),_:1}),o(r,{class:"remove-btn",onClick:he,danger:""},{default:n(()=>[i("清除")]),_:1})])]),_:1})]),_:1}),o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("单个点类:")]),_:1}),o(g,{span:18},{default:n(()=>[o(T,null,{default:n(()=>[o(r,{onClick:_e},{default:n(()=>[i("点")]),_:1}),o(r,{onClick:xe},{default:n(()=>[i("文字")]),_:1}),o(r,{class:"pad-none",onClick:be},{default:n(()=>[i("图标点")]),_:1}),o(r,{class:"pad-none",onClick:Ee},{default:n(()=>[i("小模型")]),_:1})]),_:1})]),_:1})]),_:1}),o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("二维空间:")]),_:1}),o(g,{span:18},{default:n(()=>[o(T,null,{default:n(()=>[o(r,{onClick:l[6]||(l[6]=c=>D(!1))},{default:n(()=>[i("线")]),_:1}),o(r,{class:"pad-none",onClick:l[7]||(l[7]=c=>J(!1))},{default:n(()=>[i("自由线")]),_:1}),o(r,{onClick:l[8]||(l[8]=c=>N(!1))},{default:n(()=>[i("面")]),_:1}),o(r,{onClick:l[9]||(l[9]=c=>L(!1))},{default:n(()=>[i("圆")]),_:1}),o(r,{onClick:l[10]||(l[10]=c=>W(!1))},{default:n(()=>[i("矩形")]),_:1}),o(r,{onClick:Te},{default:n(()=>[i("平面")]),_:1}),o(r,{onClick:l[11]||(l[11]=c=>U(!1))},{default:n(()=>[i("曲线")]),_:1}),o(r,{onClick:l[12]||(l[12]=c=>M(!1))},{default:n(()=>[i("走廊")]),_:1})]),_:1})]),_:1})]),_:1}),o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("二维贴地:")]),_:1}),o(g,{span:18},{default:n(()=>[o(T,null,{default:n(()=>[o(r,{onClick:l[13]||(l[13]=c=>D(!0))},{default:n(()=>[i("线")]),_:1}),o(r,{onClick:l[14]||(l[14]=c=>J(!0))},{default:n(()=>[i("自由线")]),_:1}),o(r,{onClick:l[15]||(l[15]=c=>N(!0))},{default:n(()=>[i("面")]),_:1}),o(r,{onClick:l[16]||(l[16]=c=>L(!0))},{default:n(()=>[i("圆")]),_:1}),o(r,{onClick:l[17]||(l[17]=c=>U(!0))},{default:n(()=>[i("曲线")]),_:1}),o(r,{onClick:l[18]||(l[18]=c=>M(!0))},{default:n(()=>[i("走廊")]),_:1}),o(r,{onClick:l[19]||(l[19]=c=>W(!0))},{default:n(()=>[i("矩形")]),_:1})]),_:1})]),_:1})]),_:1}),o(_,{class:"f-mb"},{default:n(()=>[o(g,{span:4,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("三维空间:")]),_:1}),o(g,{span:18},{default:n(()=>[o(T,null,{default:n(()=>[o(r,{onClick:$e},{default:n(()=>[i("球")]),_:1}),o(r,{onClick:l[20]||(l[20]=c=>z(!1))},{default:n(()=>[i("墙")]),_:1}),o(r,{onClick:Se},{default:n(()=>[i("盒子")]),_:1}),o(r,{onClick:Pe},{default:n(()=>[i("圆锥")]),_:1}),o(r,{onClick:Je},{default:n(()=>[i("圆柱")]),_:1}),o(r,{class:"pad-none",onClick:l[21]||(l[21]=c=>z(!0))},{default:n(()=>[i("闭合墙")]),_:1}),o(r,{class:"pad-none",onClick:Oe},{default:n(()=>[i("面立体")]),_:1}),o(r,{class:"pad-none",onClick:De,style:{"font-size":"12px"}},{default:n(()=>[i("矩形立体")]),_:1})]),_:1})]),_:1})]),_:1}),o(_,null,{default:n(()=>[o(g,{span:5,class:"mars-pannel-item-label f-push-5-r"},{default:n(()=>[i("其他:")]),_:1}),o(g,{span:18},{default:n(()=>[o(T,null,{default:n(()=>[o(r,{onClick:l[22]||(l[22]=c=>se())},{default:n(()=>[i("卫星")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}}),at=je(qe,[["__scopeId","data-v-d074d593"]]);export{at as default};
