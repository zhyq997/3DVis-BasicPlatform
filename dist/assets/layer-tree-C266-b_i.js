var u=(h,o,s)=>new Promise((r,c)=>{var l=t=>{try{n(s.next(t))}catch(e){c(e)}},i=t=>{try{n(s.throw(t))}catch(e){c(e)}},n=t=>t.done?r(t.value):Promise.resolve(t.value).then(l,i);n((s=s.apply(h,o)).next())});import{f as p,c as _}from"./map-BNjwlB2H.js";import{u as g,f as k,$ as y}from"./entry/index-BNp4bmLj-1732066199007.js";import{d as C,f as M,o as b,a7 as f,Z as v,a8 as w,a9 as x,k as N,J as m}from"./vue-D4H2Ux2Y.js";import"./antd-DgCI0x_J.js";const V=C({__name:"layer-tree",setup(h){const{currentWidget:o}=g(),s=M([]);let r=0;b(()=>u(this,null,function*(){const n=o.data.url,t=n.substring(0,n.lastIndexOf("/")+1)+"scenetree.json",e=yield k.get(t);if(e.data){let a=e.data;e.data.scenes&&(a=e.data.scenes[0]);const d=c(a.children);s.value.push({title:a.name,key:r,id:a.id,sphere:a.sphere?a.sphere:null,children:d})}else s.value=[]}));function c(n){if(!n)return[];r++;const t=[];return n.forEach(e=>{const a={};a.title=e.name?e.name:"element",a.key=r+"-"+Math.random(),a.id=e.id,a.sphere=e.sphere;const d=c(e.children);return d.length!==0&&(a.children=d),t.push(a)}),t}const l=(n,t)=>{const e=m(o.data.id);p(e,t.node.sphere)},i=(n,t)=>{const e=m(o.data.id);if(n.length>2e3){y(`勾选数据${n.length}大于2000，请减少勾选数量。`);return}_(e,t.checkedNodes)};return(n,t)=>{const e=f("mars-tree"),a=f("mars-dialog");return v(),w(a,{draggable:!0,title:"模型构件",width:"320","min-width":320,top:"70",bottom:"50",left:"10"},{default:x(()=>[N(e,{checkable:"","tree-data":s.value,onSelect:l,onCheck:i},null,8,["tree-data"])]),_:1})}}});export{V as default};
