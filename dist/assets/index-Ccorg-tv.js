import{eh as N,ei as R,ej as z,de as W,H as T}from"./entry/index-BNp4bmLj-1732066199007.js";import{f as k,u as s,s as L,g as U,j,d as F,b as H,a7 as P,Z as V,a8 as D,a9 as h,k as g,G as b}from"./vue-D4H2Ux2Y.js";import{P as G}from"./index-3FyLWnMM.js";import"./antd-DgCI0x_J.js";import"./useContentViewHeight-B2xTi02b.js";import"./useWindowSizeFn-Wb2xO1po.js";import"./onMountedOrActivated-B_y9TM8l.js";const A="watermark-dom",x=k(null),y=new Map;function _(n){return Array.from(y.values()).find(e=>e.targetElement===n)}function E(n,e){const r=document.createElement("canvas"),f=300,l=240;Object.assign(r,{width:f,height:l});const o=r.getContext("2d");if(o){const i=(e==null?void 0:e.fontFamily)||"Vedana",u=(e==null?void 0:e.fontSize)||15,c=(e==null?void 0:e.fontColor)||"rgba(0, 0, 0, 0.15)",d=(e==null?void 0:e.textAlign)||"left",t=(e==null?void 0:e.textBaseline)||"middle",a=(e==null?void 0:e.rotate)||20;o.rotate(-a*Math.PI/180),o.font=`${u}px ${i}`,o.fillStyle=c,o.textAlign=d,o.textBaseline=t,o.fillText(n,f/20,l)}return r.toDataURL("image/png")}const S=(n,e,r)=>{n.className="__"+A,n.style.pointerEvents="none",n.style.display="block",n.style.visibility="visible",n.style.top="0px",n.style.left="0px",n.style.position="absolute",n.style.zIndex="100000",n.style.height="100%",n.style.width="100%",n.style.background=`url(${E(s(x)||e,r)}) left top repeat`},Z=()=>new MutationObserver(e=>{var r;for(const f of e){for(const l of Array.from(f.removedNodes)){const o=_(l);if(!o)return;const{targetElement:i,parentElement:u}=o;u!=null&&u.contains(i)||(r=o==null?void 0:o.parentElement)==null||r.appendChild(l)}if(f.attributeName==="style"&&f.target){const l=f.target,o=_(l);if(o){const{waterMarkOptions:i={}}=o;S(l,l==null?void 0:l["data-watermark-text"],i)}}}});function v(n=k(document.body),e={}){const r=Symbol(A);if(s(n)&&y.has(r)){const{setWatermark:t,clear:a}=y.get(r);return{setWatermark:t,clear:a,clearAll:$}}const l=z(function(){const t=s(n);if(!t)return;const{clientHeight:a,clientWidth:m}=t;u({height:a,width:m})}),o=L(),i=()=>{var m,C;const t=s(o);o.value=void 0;const a=s(n);y.has(r)&&((C=(m=y.get(r))==null?void 0:m.obInstance)==null||C.disconnect()),y.delete(r),a&&(t&&a.removeChild(t),N(a,l))};function u(t={}){const a=s(o);a&&(W(t.width)&&(a.style.width=`${t.width}px`),W(t.height)&&(a.style.height=`${t.height}px`),W(t.str)&&(a.style.background=`url(${E(t.str,e)}) left top repeat`))}const c=t=>{var p,I;if(s(o)&&y.has(r)){x.value=t,u({str:t});return}const a=document.createElement("div");a["data-watermark-text"]=t,x.value=t,o.value=a,S(a,t,e);const m=s(n);if(!m)return;const{clientHeight:C,clientWidth:B}=m;u({str:t,width:B,height:C}),m.appendChild(a),y.set(r,{setWatermark:d,clear:i,parentElement:m,targetElement:a,obInstance:Z(),waterMarkOptions:e}),(I=(p=y.get(r))==null?void 0:p.obInstance)==null||I.observe(m,{childList:!0,subtree:!0,attributes:!0})};function d(t){c(t),R(document.documentElement,l),U()&&j(()=>{i()})}return{setWatermark:d,clear:i,clearAll:$}}function $(){Array.from(y.values()).forEach(n=>{var e;(e=n==null?void 0:n.obInstance)==null||e.disconnect(),n.clear()})}const M=F({__name:"index",setup(n){const e=k(document.body),{setWatermark:r,clear:f,clearAll:l}=v(),{setWatermark:o}=v(),{setWatermark:i}=v(e,{fontColor:"red",fontSize:12,rotate:30});return H(()=>{l()}),(u,c)=>{const d=P("a-button");return V(),D(s(G),{title:"水印示例"},{default:h(()=>[g(s(T),{class:"w-full h-32 bg-white rounded-md",title:"Global WaterMark"},{default:h(()=>[g(d,{type:"primary",class:"mr-2",onClick:c[0]||(c[0]=t=>s(r)("WaterMark Info1"))},{default:h(()=>[b(" Create Watermark1 ")]),_:1}),g(d,{type:"primary",class:"mr-2",onClick:c[1]||(c[1]=t=>s(o)("WaterMark Info2"))},{default:h(()=>[b(" Create Watermark2 ")]),_:1}),g(d,{type:"primary",class:"mr-2",onClick:c[2]||(c[2]=t=>s(i)("Custome Style WaterMark"))},{default:h(()=>[b(" Create custom style Watermark ")]),_:1}),g(d,{color:"error",class:"mr-2",onClick:s(f)},{default:h(()=>[b(" Clear Watermark1 ")]),_:1},8,["onClick"]),g(d,{color:"error",class:"mr-2",onClick:s(l)},{default:h(()=>[b(" ClearAll ")]),_:1},8,["onClick"]),g(d,{color:"warning",class:"mr-2",onClick:c[3]||(c[3]=t=>s(r)("WaterMark Info New"))},{default:h(()=>[b(" Update Watermark1 ")]),_:1})]),_:1})]),_:1})}}});export{M as default};
