var A=(e,t,o)=>new Promise((u,i)=>{var y=s=>{try{p(o.next(s))}catch(g){i(g)}},a=s=>{try{p(o.throw(s))}catch(g){i(g)}},p=s=>s.done?u(s.value):Promise.resolve(s.value).then(y,a);p((o=o.apply(e,t)).next())});import{m as r,h as R,i as F,_ as J}from"./entry/index-BNp4bmLj-1732066199007.js";import{u as W}from"./use-lifecycle-CyVQVRUS.js";import{d as Z,f as L,a7 as C,Z as q,a8 as K,a9 as h,$ as c,k as l,G as m,a2 as Q,a3 as X}from"./vue-D4H2Ux2Y.js";import"./antd-DgCI0x_J.js";let b,_,n;const Y={scene:{center:{lat:30.883785,lng:116.230883,alt:8121,heading:266,pitch:-62},globe:{depthTestAgainstTerrain:!0}}},P=new r.BaseClass;function ee(e){b=e,oe()}function te(){$(),b=null}function oe(){_=new r.thing.Measure({label:{color:"#ffffff",font_family:"楷体",font_size:20}}),b.addThing(_),_.on(r.EventType.start,function(e){M(),R()}),_.on(r.EventType.end,function(e){F()})}function V(){const e=n.height.toFixed(1),t=n.minHeight.toFixed(1),o=U(n.maxHeight);P.fire("heightVal",{baseHeight:e,minHeight:t,maxHeight:o})}function U(e){return Math.ceil(e*10)/10}function G(){_.volume({splitNum:6,exact:!1}).then(e=>{n=e,V()})}function $(){M(),_.clear(),n=null,M()}function D(e){return e&&n&&n.interPolygonObj?(ne(n.interPolygonObj.list),!0):(M(),!1)}function I(e){n.height=e,V()}function O(e){if(e>n.height){globalMsg("墙底部高度不能高于基准面高");return}n.minHeight=e}function j(e){const t=U(n.polygonMaxHeight);if(e<t){globalMsg("墙顶部高度不能低于区域内的地表高"+t),n.maxHeight=Number(t);return}if(e<n.height){globalMsg("墙顶部高度不能低于基准面高");return}n.maxHeight=e}function z(){return A(this,null,function*(){var o;if(!n||!_){globalMsg("请先开始方量分析");return}const e=yield b.graphicLayer.startDraw({type:"point",style:{color:"#00fff2"}}),t=(o=e.point)==null?void 0:o.alt;b.graphicLayer.removeGraphic(e),t&&(n.height=t,V())})}let v;function M(){v||(v=new r.layer.GraphicLayer,b.addLayer(v)),v.clear()}function ne(e){M();let t,o,u;for(let i=0,y=e.length;i<y;i++){const a=e[i];t=a.point1.pointDM,o=a.point2.pointDM,u=a.point3.pointDM;for(const H of[a.point1,a.point2,a.point3]){const w=new r.graphic.PointPrimitive({position:H.pointDM,style:{pixelSize:9,color:Cesium.Color.fromCssColorString("#ff0000").withAlpha(.5)}});v.addGraphic(w),w.bindTooltip("点高度:"+r.MeasureUtil.formatDistance(H.height))}a.area=a.area||r.MeasureUtil.getTriangleArea(t,o,u);const p=[t,o,u,t],s=new r.graphic.PolygonPrimitive({positions:p,style:{color:Cesium.Color.fromCssColorString("#ffffff").withAlpha(.01)}});v.addGraphic(s),s.bindTooltip("三角面积:"+r.MeasureUtil.formatArea(a.area)+"(第"+i+"个)");const g=new r.graphic.PolylinePrimitive({positions:p,style:{width:1,color:Cesium.Color.fromCssColorString("#ffff00").withAlpha(.3)}});v.addGraphic(g)}}const ae=Object.freeze(Object.defineProperty({__proto__:null,analysisMeasure:G,baseHeight:I,clear:$,eventTarget:P,get map(){return b},mapOptions:Y,onMounted:ee,onUnmounted:te,selHeight:z,showResult:D,txtMaxHeight:j,txtMinHeight:O},Symbol.toStringTag,{value:"Module"})),S=e=>(Q("data-v-6b902cc6"),e=e(),X(),e),ie={class:"f-mb height"},se=S(()=>c("span",{class:"mars-pannel-item-label"},"基准面高(米):",-1)),le={class:"f-mb"},re=S(()=>c("span",{class:"mars-pannel-item-label"},"围墙底高(米):",-1)),ce={class:"f-mb"},ue=S(()=>c("span",{class:"mars-pannel-item-label"},"围墙顶高(米):",-1)),pe={class:"f-mb"},he={class:"f-mb"},fe=S(()=>c("p",{class:"info"},[m(" 提示：单击分析按钮激活绘制分析，对绘制面(墙)内的进行以下计算。"),c("br"),m(" 1. 挖方量: 计算“基准面”到地表之间的凸出部分进行挖掉的体积。"),c("br"),m(" 2. 填方量：计算“基准面”与“墙底部”之间的缺少部分进行填平的体积。 ")],-1)),ge=Z({__name:"index",setup(e){W(ae);const t=L(),o=L(),u=L(),i=L(!1),y=()=>{G()},a=()=>{$()},p=()=>{const x=D(i.value);i.value=x},s=()=>{I(t.value)},g=()=>{O(o.value)},H=()=>{j(u.value)},w=()=>{z()};return P.on("heightVal",function(x){p(),t.value=x.baseHeight,o.value=x.minHeight,u.value=x.maxHeight}),(x,f)=>{const T=C("mars-input-number"),N=C("mars-button"),k=C("a-space"),B=C("a-checkbox"),E=C("mars-dialog");return q(),K(E,{right:"10",top:"60",width:"330",title:"方量分析"},{default:h(()=>[c("div",ie,[l(k,null,{default:h(()=>[se,l(T,{onChange:s,id:"inputNumber",value:t.value,"onUpdate:value":f[0]||(f[0]=d=>t.value=d),step:"0.1"},null,8,["value"]),l(N,{onClick:w},{default:h(()=>[m("点选高度")]),_:1})]),_:1})]),c("div",le,[l(k,null,{default:h(()=>[re,l(T,{onChange:g,id:"inputNumber",value:o.value,"onUpdate:value":f[1]||(f[1]=d=>o.value=d),step:"0.1"},null,8,["value"])]),_:1})]),c("div",ce,[l(k,null,{default:h(()=>[ue,l(T,{onChange:H,id:"inputNumber",value:u.value,"onUpdate:value":f[2]||(f[2]=d=>u.value=d),step:"0.1"},null,8,["value"])]),_:1})]),c("div",pe,[l(k,{size:10},{default:h(()=>[l(N,{class:"btn",onClick:y},{default:h(()=>[m("绘制分析区域")]),_:1}),l(N,{danger:"",class:"btn",onClick:a},{default:h(()=>[m("清除")]),_:1})]),_:1})]),c("div",he,[l(B,{onChange:p,checked:i.value,"onUpdate:checked":f[3]||(f[3]=d=>i.value=d)},{default:h(()=>[m("显示面内三角网")]),_:1},8,["checked"])]),fe]),_:1})}}}),xe=J(ge,[["__scopeId","data-v-6b902cc6"]]);export{xe as default};
